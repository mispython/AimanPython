#!/usr/bin/env python3
"""
File Name: WALWPBBF
Format Definition File for WALWPBBP
"""

import os
from pathlib import Path
import polars as pl
from typing import Dict, List, Tuple

# =====================================================
# Configuration and Path Setup
# =====================================================

DATA_DIR = Path("data")
INPUT_DIR = DATA_DIR / "input"
OUTPUT_DIR = DATA_DIR / "output"
PARQUET_DIR = INPUT_DIR / "parquet"

# Create directories if they don't exist
OUTPUT_DIR.mkdir(parents=True, exist_ok=True)
PARQUET_DIR.mkdir(parents=True, exist_ok=True)

# Output files for format tables
WALW_FORMATS_FILE = PARQUET_DIR / "walw_formats.parquet"
DAYITEM_FILE = PARQUET_DIR / "dayitem.parquet"

# =====================================================
# Format Data Definition
# =====================================================

# Format data structure: (SET_ID, BNMCODE, FMTNAME, TYPE)
# This is the complete Walker format mapping from X_WALWPBBF
WALW_FORMAT_DATA = [
    ("F130240NA", "3024000000000Y", "BNMCODE", "C"),
    ("F230910MGS", "3091000000000Y", "BNMCODE", "C"),
    ("F230920MGII", "3092000000000Y", "BNMCODE", "C"),
    ("F230930TB", "3093000000000Y", "BNMCODE", "C"),
    ("F132110SDBNM", "3211001000000Y", "BNMCODE", "C"),
    ("F132121BBNM", "3212001000000Y", "BNMCODE", "C"),
    ("F132120BCACB", "3212002000000Y", "BNMCODE", "C"),
    ("FXX1", "3212003000000Y", "BNMCODE", "C"),
    ("F132130FDDBI", "3213002000000Y", "BNMCODE", "C"),
    ("F13213011FC", "3213020000000Y", "BNMCODE", "C"),
    ("F13213012NA", "3213012000000Y", "BNMCODE", "C"),
    ("F13213110DBI", "3213111000000Y", "BNMCODE", "C"),
    ("F132141CALL", "3214013000000Y", "BNMCODE", "C"),
    ("F13219902CB", "3219902000000Y", "BNMCODE", "C"),
    ("F132300IDBI", "3230010000000Y", "BNMCODE", "C"),
    ("F132500RR", "3250001000000Y", "BNMCODE", "C"),
    ("F13250011NA", "3250011000000Y", "BNMCODE", "C"),
    ("F13250012NA", "3250012000000Y", "BNMCODE", "C"),
    ("F13250013NA", "3250013000000Y", "BNMCODE", "C"),
    ("F132600NA", "3260000000000Y", "BNMCODE", "C"),
    ("F132620FXCA", "3262000000000Y", "BNMCODE", "C"),
    ("F132800NA", "3280000000000Y", "BNMCODE", "C"),
    ("F133110ODVCB", "3311002000000Y", "BNMCODE", "C"),
    ("F133110VFBI", "3311081000000Y", "BNMCODE", "C"),
    ("F13312002CB", "3312002000000Y", "BNMCODE", "C"),
    ("F13312003IB", "3312003000000Y", "BNMCODE", "C"),
    ("F133130", "3313000000000Y", "BNMCODE", "C"),
    ("F13313002SCB", "3313002000000Y", "BNMCODE", "C"),
    ("F13313003SIB", "3313003000000Y", "BNMCODE", "C"),
    ("F13314001BNM", "3314001000000Y", "BNMCODE", "C"),
    ("F13314002CB", "3314002000000Y", "BNMCODE", "C"),
    ("F13314003IB", "3314003000000Y", "BNMCODE", "C"),
    ("F13314011FC", "3314011000000Y", "BNMCODE", "C"),
    ("F13314012MB", "3314012000000Y", "BNMCODE", "C"),
    ("F13314013DH", "3314013000000Y", "BNMCODE", "C"),
    ("F133141DHON", "3314013110000Y", "BNMCODE", "C"),
    ("F13314017CAG", "3314017000000Y", "BNMCODE", "C"),
    ("F133140DNBFI", "3314020000000Y", "BNMCODE", "C"),
    ("F133620FNFBI", "3362081000000Y", "BNMCODE", "C"),
    ("F13364002CB", "3364002000000Y", "BNMCODE", "C"),
    ("F13364003NA", "3364003000000Y", "BNMCODE", "C"),
    ("F13364003IB", "3364003I00000Y", "BNMCODE", "C"),
    ("F13364012MB", "3364012000000Y", "BNMCODE", "C"),
    ("F1336408110A", "3364081100000Y", "BNMCODE", "C"),
    ("F1336408110B", "3364081100000Y", "BNMCODE", "C"),
    ("F13410002NA", "3410002000000Y", "BNMCODE", "C"),
    ("F13410003NA", "3410003000000Y", "BNMCODE", "C"),
    ("F13410011NA", "3410011000000Y", "BNMCODE", "C"),
    ("F13410012NA", "3410012000000Y", "BNMCODE", "C"),
    ("F13410013NA", "3410013000000Y", "BNMCODE", "C"),
    ("F13410017NA", "3410017000000Y", "BNMCODE", "C"),
    ("F13410079DOE", "3410079000000Y", "BNMCODE", "C"),
    ("F134600NA", "3460000000000Y", "BNMCODE", "C"),
    ("F142199ODA", "4219900000000Y", "BNMCODE", "C"),
    ("F154121CAGA", "5412100000000Y", "BNMCODE", "C"),
    ("F235013QSMP", "3501300000000Y", "BNMCODE", "C"),
    ("F235030NID", "3503000000000Y", "BNMCODE", "C"),
    ("F235210MGS", "3521000000000Y", "BNMCODE", "C"),
    ("F235220TB", "3522000000000Y", "BNMCODE", "C"),
    ("F235230MGII", "3523000000000Y", "BNMCODE", "C"),
    ("F235250BNM", "3525000000000Y", "BNMCODE", "C"),
    ("F235260KB", "3526000000000Y", "BNMCODE", "C"),
    ("F235270DHB", "3527000000000Y", "BNMCODE", "C"),
    ("F235280DMB", "3528000000000Y", "BNMCODE", "C"),
    ("F235420UCB", "3542000000000Y", "BNMCODE", "C"),
    ("F235430CN", "3543000000000Y", "BNMCODE", "C"),
    ("F235510CN", "3551000000000Y", "BNMCODE", "C"),
    ("F235520CT1", "3552000000000Y", "BNMCODE", "C"),
    ("F235530CT2", "3553000000000Y", "BNMCODE", "C"),
    ("F235549OCDS", "3555000000000Y", "BNMCODE", "C"),
    ("F235599RMOS", "3559900000000Y", "BNMCODE", "C"),
    ("F235699FXOS", "3569900000000Y", "BNMCODE", "C"),
    ("F236013QSMP", "3601300000000Y", "BNMCODE", "C"),
    ("F236021QSLC", "3602100000000Y", "BNMCODE", "C"),
    ("F236030NIDH", "3603000000000Y", "BNMCODE", "C"),
    ("F236040ACP", "3604000000000Y", "BNMCODE", "C"),
    ("F236070PTU", "3607000000000Y", "BNMCODE", "C"),
    ("F236210MGS", "3621000000000Y", "BNMCODE", "C"),
    ("F236220TB", "3622000000000Y", "BNMCODE", "C"),
    ("F236230MGII", "3623000000000Y", "BNMCODE", "C"),
    ("F236250BNM", "3625000000000Y", "BNMCODE", "C"),
    ("F236260KB", "3626000000000Y", "BNMCODE", "C"),
    ("F236270DHB", "3627000000000Y", "BNMCODE", "C"),
    ("F236280DMB", "3628000000000Y", "BNMCODE", "C"),
    ("F236420UCB", "3642000000000Y", "BNMCODE", "C"),
    ("F236430CN", "3643000000000Y", "BNMCODE", "C"),
    ("F236510CN", "3651000000000Y", "BNMCODE", "C"),
    ("F236520CT1", "3652000000000Y", "BNMCODE", "C"),
    ("F236530CT2", "3653000000000Y", "BNMCODE", "C"),
    ("F236549OCDS", "3655000000000Y", "BNMCODE", "C"),
    ("F236650FXCDS", "3665000000000Y", "BNMCODE", "C"),
    ("F236699FXOS", "3669900000000Y", "BNMCODE", "C"),
    ("F137010SH", "3701000000000Y", "BNMCODE", "C"),
    ("F137030NIDH", "3703000000000Y", "BNMCODE", "C"),
    ("F137040ACP", "3704000000000Y", "BNMCODE", "C"),
    ("F137070PTU", "3707000000000Y", "BNMCODE", "C"),
    ("F137210MGS", "3721000000000Y", "BNMCODE", "C"),
    ("F137220TB", "3722000000000Y", "BNMCODE", "C"),
    ("F137230MGII", "3723000000000Y", "BNMCODE", "C"),
    ("F137250BNM", "3725000000000Y", "BNMCODE", "C"),
    ("F137260KB", "3726000000000Y", "BNMCODE", "C"),
    ("F137270DHB", "3727000000000Y", "BNMCODE", "C"),
    ("F137280DMB", "3728000000000Y", "BNMCODE", "C"),
    ("FXX6", "3741000000000Y", "BNMCODE", "C"),
    ("F137420UCB", "3742000000000Y", "BNMCODE", "C"),
    ("F137430CN", "3743000000000Y", "BNMCODE", "C"),
    ("F137510CN", "3751000000000Y", "BNMCODE", "C"),
    ("F137520CT1", "3752000000000Y", "BNMCODE", "C"),
    ("F137530CT2", "3753000000000Y", "BNMCODE", "C"),
    ("F137549OCDS", "3755000000000Y", "BNMCODE", "C"),
    ("F137599RMOS", "3759900000000Y", "BNMCODE", "C"),
    ("F137600NA", "3760000000000Y", "BNMCODE", "C"),
    ("F137610FXSH", "3761000000000Y", "BNMCODE", "C"),
    ("FXX9", "3762000100000Y", "BNMCODE", "C"),
    ("FX10", "3762000200000Y", "BNMCODE", "C"),
    ("FX11", "3763000100000Y", "BNMCODE", "C"),
    ("FX12", "3763000200000Y", "BNMCODE", "C"),
    ("FX13", "3764000100000Y", "BNMCODE", "C"),
    ("FX14", "3764000200000Y", "BNMCODE", "C"),
    ("FX15", "3765000100000Y", "BNMCODE", "C"),
    ("F137650FXCDS", "3765000200000Y", "BNMCODE", "C"),
    ("F137699FXOS", "3769900000000Y", "BNMCODE", "C"),
    ("F138030NID", "3803000000000Y", "BNMCODE", "C"),
    ("F138210MGS", "3821000000000Y", "BNMCODE", "C"),
    ("F138220TB", "3822000000000Y", "BNMCODE", "C"),
    ("F138250BNM", "3825000000000Y", "BNMCODE", "C"),
    ("F138260KB", "3826000000000Y", "BNMCODE", "C"),
    ("F138270DHB", "3827000000000Y", "BNMCODE", "C"),
    ("F138280DMB", "3828000000000Y", "BNMCODE", "C"),
    ("F138400CDS", "3840000000000Y", "BNMCODE", "C"),
    ("F138500CAGA", "3850100000000Y", "BNMCODE", "C"),
    ("F138599RMDS", "3859900000000Y", "BNMCODE", "C"),
    ("F138600FX", "3860000000000Y", "BNMCODE", "C"),
    ("F239230E", "3910000000000Y", "BNMCODE", "C"),
    ("F239109GOLD", "3910900000000Y", "BNMCODE", "C"),
    ("F239190GDWLL", "3919000000000Y", "BNMCODE", "C"),
    ("F139111CASH", "3911000000000Y", "BNMCODE", "C"),
    ("F239121QUO", "3912100000000Y", "BNMCODE", "C"),
    ("F239122UNQUO", "3912200000000Y", "BNMCODE", "C"),
    ("F239132UNASS", "3913200000000Y", "BNMCODE", "C"),
    ("F239140INVFD", "3914000000000Y", "BNMCODE", "C"),
    ("F239151LAND", "3915100000000Y", "BNMCODE", "C"),
    ("F239152TRANS", "3915200000000Y", "BNMCODE", "C"),
    ("F239153OEFUR", "3915300000000Y", "BNMCODE", "C"),
    ("F239154COMP", "3915400000000Y", "BNMCODE", "C"),
    ("F239159OFA", "3915900000000Y", "BNMCODE", "C"),
    ("F239160FPROP", "3916000000000Y", "BNMCODE", "C"),
    ("F239170DA", "3917000000000Y", "BNMCODE", "C"),
    ("F239210INTR", "3921000000000Y", "BNMCODE", "C"),
    ("F239220CHQP", "3922000000000Y", "BNMCODE", "C"),
    ("F239230IBR", "3923000000000Y", "BNMCODE", "C"),
    ("F239290REC", "3929000000000Y", "BNMCODE", "C"),
    ("F239299OA", "3929900000000Y", "BNMCODE", "C"),
    ("F139610FXNC", "3961000000000Y", "BNMCODE", "C"),
    ("F139611FXINV", "3961100000000Y", "BNMCODE", "C"),
    ("F239620FOSUB", "3962000000000Y", "BNMCODE", "C"),
    ("F239630FOASS", "3963000000000Y", "BNMCODE", "C"),
    ("FX17", "3965000000000Y", "BNMCODE", "C"),
    ("FX18", "3966000000000Y", "BNMCODE", "C"),
    ("F139669LAB", "3966900000000Y", "BNMCODE", "C"),
    ("FX19", "3967000000000Y", "BNMCODE", "C"),
    ("F139680FXINT", "3968000000000Y", "BNMCODE", "C"),
    ("F139690FXREC", "3969000000000Y", "BNMCODE", "C"),
    ("F139699FXOA", "3969900000000Y", "BNMCODE", "C"),
    ("F139799NA", "3979900000000Y", "BNMCODE", "C"),
    ("F140140NA", "4014000000000Y", "BNMCODE", "C"),
    ("F140190SRGF", "4019000000000Y", "BNMCODE", "C"),
    ("F241109PRR", "4110900000000Y", "BNMCODE", "C"),
    ("F241101OSC", "4110100000000Y", "BNMCODE", "C"),
    ("F241102SP", "4110200000000Y", "BNMCODE", "C"),
    ("F241103SRF", "4110300000000Y", "BNMCODE", "C"),
    ("F241104GRF", "4110400000000Y", "BNMCODE", "C"),
    ("F241105RPAL", "4110500000000Y", "BNMCODE", "C"),
    ("F241106AAPL", "4110600000000Y", "BNMCODE", "C"),
    ("F241107CUPL", "4110700000000Y", "BNMCODE", "C"),
    ("F241111CRR", "4111100000000Y", "BNMCODE", "C"),
    ("F142170WT", "4217071000000Y", "BNMCODE", "C"),
    ("F142180HDAD", "4218060000000Y", "BNMCODE", "C"),
    ("F142510FDA", "4251000000000Y", "BNMCODE", "C"),
    ("F142599OELED", "4259900000000Y", "BNMCODE", "C"),
    ("F142600B", "4369981000000Y", "BNMCODE", "C"),
    ("F142600C", "4369981000000Y", "BNMCODE", "C"),
    ("F143120ODNCB", "4312002000000Y", "BNMCODE", "C"),
    ("F143120ODNIB", "4312003000000Y", "BNMCODE", "C"),
    ("F143130", "4313000000000Y", "BNMCODE", "C"),
    ("F14313002DCB", "4313002000000Y", "BNMCODE", "C"),
    ("F14313003DIB", "4313003000000Y", "BNMCODE", "C"),
    ("F14314003IB", "4314003000000Y", "BNMCODE", "C"),
    ("F14314007IIB", "4314007000000Y", "BNMCODE", "C"),
    ("F14314001BNM", "4314001000000Y", "BNMCODE", "C"),
    ("F14314002CB", "4314002000000Y", "BNMCODE", "C"),
    ("F14314011FC", "4314011000000Y", "BNMCODE", "C"),
    ("F14314012MB", "4314012000000Y", "BNMCODE", "C"),
    ("F14314013DH", "4314013000000Y", "BNMCODE", "C"),
    ("F14314017CAG", "4314017000000Y", "BNMCODE", "C"),
    ("F143140811FB", "4314081100000Y", "BNMCODE", "C"),
    ("F14314020", "4314020000000Y", "BNMCODE", "C"),
    ("F143620FNFBI", "4362081000000Y", "BNMCODE", "C"),
    ("F14364002CB", "4364002000000Y", "BNMCODE", "C"),
    ("F14364003NA", "4364003000000Y", "BNMCODE", "C"),
    ("F14364003IB", "4364003I00000Y", "BNMCODE", "C"),
    ("F14364012MB", "4364012000000Y", "BNMCODE", "C"),
    ("F143640811FB", "4364081100000Y", "BNMCODE", "C"),
    ("F144140CAGA", "4414000000000Y", "BNMCODE", "C"),
    ("F144611NA", "4461100000000Y", "BNMCODE", "C"),
    ("F144611FXSDC", "4461100000000Y", "BNMCODE", "C"),
    ("F147600", "4760000000000Y", "BNMCODE", "C"),
    ("F147600NA", "4760000000000Y", "BNMCODE", "C"),
    ("F147100", "4710000000000Y", "BNMCODE", "C"),
    ("F249130AP", "4913000000000Y", "BNMCODE", "C"),
    ("F249150SPBDD", "4915000000000Y", "BNMCODE", "C"),
    ("F249160GPBDD", "4916000000000Y", "BNMCODE", "C"),
    ("F249660F", "4966000000000F", "BNMCODE", "C"),
    ("F249170IIS", "4917000000000Y", "BNMCODE", "C"),
    ("F249189PDVS", "4918900000000Y", "BNMCODE", "C"),
    ("F249190PDVDS", "4919000000000Y", "BNMCODE", "C"),
    ("F249220DFA", "4922000000000Y", "BNMCODE", "C"),
    ("F249230PTAX", "4923000000000Y", "BNMCODE", "C"),
    ("F249240DT", "4924000000000Y", "BNMCODE", "C"),
    ("F249250DP", "4925000000000Y", "BNMCODE", "C"),
    ("F249270IBPER", "4927000000000Y", "BNMCODE", "C"),
    ("F14911050IPR", "4911050000000Y", "BNMCODE", "C"),
    ("F14911080INR", "4911080000000Y", "BNMCODE", "C"),
    ("F249120BP", "4912050000000Y", "BNMCODE", "C"),
    ("F14912080BP", "4912080000000Y", "BNMCODE", "C"),
    ("F247610", "4761000000000Y", "BNMCODE", "C"),
    ("F249181SSC", "4918100000000Y", "BNMCODE", "C"),
    ("F249299OL", "4929950000000Y", "BNMCODE", "C"),
    ("F14929980NA", "4929980000000Y", "BNMCODE", "C"),
    ("F14961050IPR", "4961050000000Y", "BNMCODE", "C"),
    ("F14961080FX", "4961080000000Y", "BNMCODE", "C"),
    ("F14969950NA", "4969950000000Y", "BNMCODE", "C"),
    ("F149699", "4969980000000Y", "BNMCODE", "C"),
    ("F149699FXIIS", "4969980000000Y", "BNMCODE", "C"),
    ("F254121HLCR", "5412100000000Y", "BNMCODE", "C"),
    ("F254130SBBA", "5413000000000Y", "BNMCODE", "C"),
    ("F254210FAP", "5421000000000Y", "BNMCODE", "C"),
    ("F258600FXIRR", "5860000000000Y", "BNMCODE", "C"),
    ("F259910OBC", "5991000000000Y", "BNMCODE", "C"),
    ("F259920BA", "5992000000000Y", "BNMCODE", "C"),
    ("F259999MISC", "5999900000000Y", "BNMCODE", "C"),
    ("F249400", "4940050000000Y", "BNMCODE", "C"),
    ("F142199SIP", "4219900000000Y", "BNMCODE", "C"),
    ("F142190STD", "4219000000000Y", "BNMCODE", "C"),
    ("F142191ILD", "4219100000000Y", "BNMCODE", "C"),
    ("F142191DCI", "4219100000000Y", "BNMCODE", "C"),
    ("F149299CRA", "4219100000000Y", "BNMCODE", "C"),
    ("F142691FXDCI", "4269100000000Y", "BNMCODE", "C"),
    ("F142199B", "4219976000000Y", "BNMCODE", "C"),
    ("F142199D", "4219976000000Y", "BNMCODE", "C"),
    ("F241400", "4100000000000Y", "BNMCODE", "C"),
    ("F259500", "5950000000000Y", "BNMCODE", "C"),
    ("F259700", "5970000000000Y", "BNMCODE", "C"),
    ("F144111RM", "4411100000000Y", "BNMCODE", "C"),
    ("F144130LEASE", "4413000000000Y", "BNMCODE", "C"),
    ("F143110VIB", "4311003000000Y", "BNMCODE", "C"),
    ("F143110VLB", "4311002000000Y", "BNMCODE", "C"),
    ("F133110ODVIB", "3311003000000Y", "BNMCODE", "C"),
    ("F143110VFBI", "4311081000000Y", "BNMCODE", "C"),
    ("F142699C", "4369903000000Y", "BNMCODE", "C"),
    ("F247299", "4729900000000Y", "BNMCODE", "C"),
    ("F144111", "4411100000000Y", "BNMCODE", "C"),
    ("F133699IB", "3369003000000F", "BNMCODE", "C"),
    ("F133650CB", "3369002000000F", "BNMCODE", "C"),
    ("F143650CB", "4369902000000Y", "BNMCODE", "C"),
]

# Format data for DAYA entries
DAYA_FORMAT_DATA = [
    ("F235520CT1", "3552000000000Y", "DAYA", "C"),
    ("F235530CT2", "3553000000000Y", "DAYA", "C"),
    ("F235549OCDS", "3555000000000Y", "DAYA", "C"),
    ("F144140CAGA", "4414000000000Y", "DAYA", "C"),
    ("F130091OLA", "3009100000000Y", "DAYA", "C"),
    ("F130221MLTB", "3022100000000Y", "DAYA", "C"),
    ("F130231ALTB", "3023100000000Y", "DAYA", "C"),
    ("F130240NA", "3024100000000Y", "DAYA", "C"),
    ("F132121BBNM", "3212101000000Y", "DAYA", "C"),
    ("F132141CALL", "3214113000000Y", "DAYA", "C"),
    ("F13219902CB", "3219902000000Y", "DAYA", "C"),
    ("F133141DHON", "3314113110000Y", "DAYA", "C"),
    ("F142190STD", "4219000000000Y", "DAYA", "C"),
    ("F142191ILD", "4219100000000Y", "DAYA", "C"),
    ("F142191DCI", "4219100000000Y", "DAYA", "C"),
    ("F149299CRA", "4219100000000Y", "DAYA", "C"),
    ("F142691FXDCI", "4269100000000Y", "DAYA", "C"),
    ("F142199ODA", "4219900000000Y", "DAYA", "C"),
    ("F235210MGS", "3521100000000Y", "DAYA", "C"),
    ("F235220TB", "3522100000000Y", "DAYA", "C"),
    ("F235250BNM", "3525100000000Y", "DAYA", "C"),
    ("F235270DHB", "3527000000000Y", "DAYA", "C"),
    ("F235280DMB", "3528000000000Y", "DAYA", "C"),
    ("F235420UCB", "3542000000000Y", "DAYA", "C"),
    ("F235430CN", "3543000000000Y", "DAYA", "C"),
    ("F235510CN", "3551000000000Y", "DAYA", "C"),
    ("F236210MGS", "3621100000000Y", "DAYA", "C"),
    ("F236220TB", "3622100000000Y", "DAYA", "C"),
    ("F236250BNM", "3625100000000Y", "DAYA", "C"),
    ("F236270DHB", "3627000000000Y", "DAYA", "C"),
    ("F236280DMB", "3628000000000Y", "DAYA", "C"),
    ("F236420UCB", "3642000000000Y", "DAYA", "C"),
    ("F236430CN", "3643000000000Y", "DAYA", "C"),
    ("F236510CN", "3651100000000Y", "DAYA", "C"),
    ("F236520CT1", "3652100000000Y", "DAYA", "C"),
    ("F137201GDS", "3720100000000Y", "DAYA", "C"),
    ("F137251BNMDS", "3725100000000Y", "DAYA", "C"),
    ("F137351CIDS", "3735100000000Y", "DAYA", "C"),
    ("F137510CN", "3751100000000Y", "DAYA", "C"),
    ("F137520CT1", "3752100000000Y", "DAYA", "C"),
    ("F137530CT2", "3753100000000Y", "DAYA", "C"),
    ("F139111CASH", "3911100000000Y", "DAYA", "C"),
    ("F140140NA", "4014100000000Y", "DAYA", "C"),
    ("F140150CBT2", "4015100000000Y", "DAYA", "C"),
    ("F142199SIP", "4219900000000Y", "DAYA", "C"),
    ("F13314003IB", "3314003000000Y", "DAYA", "C"),
    ("F14314003IB", "4314003000000Y", "DAYA", "C"),
    ("F143140811FB", "4314081100000Y", "DAYA", "C"),
    ("F144111RM", "4411100000000Y", "DAYA", "C"),
    ("F144130LEASE", "4413000000000Y", "DAYA", "C"),
    ("F143110VIB", "4311003000000Y", "DAYA", "C"),
    ("F143110VLB", "4311002000000Y", "DAYA", "C"),
    ("F133110ODVIB", "3311003000000Y", "DAYA", "C"),
    ("F143110VFBI", "4311081000000Y", "DAYA", "C"),
    ("F14314020", "4314020000000Y", "DAYA", "C"),
    ("F144111", "4411100000000Y", "DAYA", "C"),
    ("F142133CM", "4213300000000Y", "DAYA", "C"),
]

# Format data for EL (End of Life) entries
EL_FORMAT_DATA = [
    ("F235510CN", "3551000000000Y", "EL", "C"),
    ("F235520CT1", "3552000000000Y", "EL", "C"),
    ("F235530CT2", "3553000000000Y", "EL", "C"),
    ("F235549OCDS", "3555000000000Y", "EL", "C"),
    ("F144140CAGA", "4414000000000Y", "EL", "C"),
    ("F140190SRGF", "4019000000000Y", "EL", "C"),
    ("F132120BCACB", "3212002000000Y", "EL", "C"),
    ("F132130FDDBI", "3213002000000Y", "EL", "C"),
    ("F13213011FC", "3213020000000Y", "EL", "C"),
    ("F13213012NA", "3213012000000Y", "EL", "C"),
    ("F132300IDBI", "3230010000000Y", "EL", "C"),
    ("F132500RR", "3250001000000Y", "EL", "C"),
    ("F13250011NA", "3250011000000Y", "EL", "C"),
    ("F13250012NA", "3250012000000Y", "EL", "C"),
    ("F13250013NA", "3250013000000Y", "EL", "C"),
    ("F132600NA", "3260000000000Y", "EL", "C"),
    ("F132800NA", "3280000000000Y", "EL", "C"),
    ("F13219902CB", "3219902000000Y", "EL", "C"),
    ("F133110ODVCB", "3311002000000Y", "EL", "C"),
    ("F13312002CB", "3312002000000Y", "EL", "C"),
    ("F133130", "3313000000000Y", "EL", "C"),
    ("F13314001BNM", "3314001000000Y", "EL", "C"),
    ("F13314002CB", "3314002000000Y", "EL", "C"),
    ("F13314003IB", "3314003000000Y", "EL", "C"),
    ("F14314003IB", "4314003000000Y", "EL", "C"),
    ("F14314020", "4314020000000Y", "EL", "C"),
    ("F13314011FC", "3314011000000Y", "EL", "C"),
    ("F13314012MB", "3314012000000Y", "EL", "C"),
    ("F13314013DH", "3314013000000Y", "EL", "C"),
    ("F133141DHON", "3314013110000Y", "EL", "C"),
    ("F13314017CAG", "3314017000000Y", "EL", "C"),
    ("F133140DNBFI", "3314020000000Y", "EL", "C"),
    ("F13330001BNM", "3330001000000Y", "EL", "C"),
    ("F13330002CB", "3330002000000Y", "EL", "C"),
    ("F13330003NA", "3330003000000Y", "EL", "C"),
    ("F13330011NA", "3330011000000Y", "EL", "C"),
    ("F13330012NA", "3330012000000Y", "EL", "C"),
    ("F13330013NA", "3330013000000Y", "EL", "C"),
    ("F13330017NA", "3330017000000Y", "EL", "C"),
    ("F13330081NA", "3330081000000Y", "EL", "C"),
    ("F133620FNFBI", "3362081000000Y", "EL", "C"),
    ("F13364002CB", "3364002000000Y", "EL", "C"),
    ("F13364003NA", "3364003000000Y", "EL", "C"),
    ("F13364003IB", "3364003I00000Y", "EL", "C"),
    ("F13364012MB", "3364012000000Y", "EL", "C"),
    ("F1336408110A", "3364081100000Y", "EL", "C"),
    ("F1336408110B", "3364081100000Y", "EL", "C"),
    ("F133700IFFI", "3370000000000Y", "EL", "C"),
    ("F13410002NA", "3410002000000Y", "EL", "C"),
    ("F13410003NA", "3410003000000Y", "EL", "C"),
    ("F13410011NA", "3410011000000Y", "EL", "C"),
    ("F13410012NA", "3410012000000Y", "EL", "C"),
    ("F13410013NA", "3410013000000Y", "EL", "C"),
    ("F13410017NA", "3410017000000Y", "EL", "C"),
    ("F134600NA", "3460000000000Y", "EL", "C"),
    ("F13460064FLB", "3460064000000Y", "EL", "C"),
    ("F13460081BCB", "3460081000000Y", "EL", "C"),
    ("F235270DHB", "3527000000000Y", "EL", "C"),
    ("F235280DMB", "3528000000000Y", "EL", "C"),
    ("F235420UCB", "3542000000000Y", "EL", "C"),
    ("F235430CN", "3543000000000Y", "EL", "C"),
    ("F236270DHB", "3627000000000Y", "EL", "C"),
    ("F236280DMB", "3628000000000Y", "EL", "C"),
    ("F236420UCB", "3642000000000Y", "EL", "C"),
    ("F236430CN", "3643000000000Y", "EL", "C"),
    ("F137030NIDH", "3703000000000Y", "EL", "C"),
    ("F137201GDS", "3720000000000Y", "EL", "C"),
    ("F137210MGS", "3721000000000Y", "EL", "C"),
    ("F137220TB", "3722000000000Y", "EL", "C"),
    ("F137230MGII", "3723000000000Y", "EL", "C"),
    ("F235230MGII", "3523000000000Y", "EL", "C"),
    ("F137250BNM", "3725000000000Y", "EL", "C"),
    ("F137260KB", "3726000000000Y", "EL", "C"),
    ("F137510CN", "3751000000000Y", "EL", "C"),
    ("F137520CT1", "3752000000000Y", "EL", "C"),
    ("F137530CT2", "3753000000000Y", "EL", "C"),
    ("F137549OCDS", "3755000000000Y", "EL", "C"),
    ("F137600NA", "3760000000000Y", "EL", "C"),
    ("F137650FXCDS", "3765000200000Y", "EL", "C"),
    ("F137699FXOS", "3769900000000Y", "EL", "C"),
    ("F137610FXSH", "3761000000000Y", "EL", "C"),
    ("F139610FXNC", "3961000000000Y", "EL", "C"),
    ("F139611FXINV", "3961100000000Y", "EL", "C"),
    ("F139669LAB", "3966900000000Y", "EL", "C"),
    ("F139670NA", "3967000000000Y", "EL", "C"),
    ("F139680FXINT", "3968000000000Y", "EL", "C"),
    ("F139699FXOA", "3969900000000Y", "EL", "C"),
    ("F139799NA", "3979900000000Y", "EL", "C"),
    ("F241109PRR", "4100000000000Y", "EL", "C"),
    ("F142110DDEP", "4211000000000Y", "EL", "C"),
    ("F142120SA", "4212000000000Y", "EL", "C"),
    ("F142130FD", "4213000000000Y", "EL", "C"),
    ("F142132GID", "4213200000000Y", "EL", "C"),
    ("F142150NIDI", "4215000000000Y", "EL", "C"),
    ("F142160RA", "4216000000000Y", "EL", "C"),
    ("F142170WT", "4217071000000Y", "EL", "C"),
    ("F142180HDAD", "4218000000000Y", "EL", "C"),
    ("F142600FXDEP", "4260000000000Y", "EL", "C"),
    ("F142190STD", "4219000000000Y", "EL", "C"),
    ("F142191ILD", "4219100000000Y", "EL", "C"),
    ("F142191DCI", "4219100000000Y", "EL", "C"),
    ("F149299CRA", "4219100000000Y", "EL", "C"),
    ("F142691FXDCI", "4269100000000Y", "EL", "C"),
    ("F142199ODA", "4219900000000Y", "EL", "C"),
    ("F143120ODNCB", "4312002000000Y", "EL", "C"),
    ("F143120ODNIB", "4312003000000Y", "EL", "C"),
    ("F143130", "4313000000000Y", "EL", "C"),
    ("F14314001BNM", "4314001000000Y", "EL", "C"),
    ("F14314002CB", "4314002000000Y", "EL", "C"),
    ("F14314011FC", "4314011000000Y", "EL", "C"),
    ("F14314012MB", "4314012000000Y", "EL", "C"),
    ("F14314013DH", "4314013000000Y", "EL", "C"),
    ("F14314017CAG", "4314017000000Y", "EL", "C"),
    ("F143140811FB", "4314081100000Y", "EL", "C"),
    ("F14330001NA", "4330001000000Y", "EL", "C"),
    ("F14330002CB", "4330002000000Y", "EL", "C"),
    ("F14330003NA", "4330003000000Y", "EL", "C"),
    ("F14330011NA", "4330011000000Y", "EL", "C"),
    ("F14330012NA", "4330012000000Y", "EL", "C"),
    ("F14330013NA", "4330013000000Y", "EL", "C"),
    ("F14330017NA", "4330017000000Y", "EL", "C"),
    ("F14330081NA", "4330081000000Y", "EL", "C"),
    ("F143620FNFBI", "4362081000000Y", "EL", "C"),
    ("F14364002CB", "4364002000000Y", "EL", "C"),
    ("F14364003NA", "4364003000000Y", "EL", "C"),
    ("F14364003IB", "4364003I00000Y", "EL", "C"),
    ("F14364012MB", "4364012000000Y", "EL", "C"),
    ("F143640811FB", "4364081100000Y", "EL", "C"),
    ("F143700NA", "4370000000000Y", "EL", "C"),
    ("F144111RM", "4411100000000Y", "EL", "C"),
    ("F144130LEASE", "4413000000000Y", "EL", "C"),
    ("F144600NA", "4460000000000Y", "EL", "C"),
    ("F147600", "4760000000000Y", "EL", "C"),
    ("F147600NA", "4760000000000Y", "EL", "C"),
    ("F14911080INR", "4911080000000Y", "EL", "C"),
    ("F14912080BP", "4912080000000Y", "EL", "C"),
    ("F14929980NA", "4929980000000Y", "EL", "C"),
    ("F14932080NA", "4932080000000Y", "EL", "C"),
    ("F14961050IPR", "4961050000000Y", "EL", "C"),
    ("F14961080FX", "4961080000000Y", "EL", "C"),
    ("F14969950NA", "4969950000000Y", "EL", "C"),
    ("F149699", "4969980000000Y", "EL", "C"),
    ("F149699FXIIS", "4969980000000Y", "EL", "C"),
    ("F14979950NA", "4979950000000Y", "EL", "C"),
    ("F14979980NA", "4979980000000Y", "EL", "C"),
    ("F13312003IB", "3312003000000Y", "EL", "C"),
    ("F138030NID", "3803000000000Y", "EL", "C"),
    ("F140150CBT2", "4015000000000Y", "EL", "C"),
    ("F247610", "4761000000000Y", "EL", "C"),
    ("SSTS", "SSTS", "EL", "C"),
    ("NSSTS", "NSSTS", "EL", "C"),
    ("TRADING", "NSSTS TRADING", "EL", "C"),
    ("INVESTMENT", "NSSTS INVEST", "EL", "C"),
    ("F239620FOSUB", "3962000000000Y", "EL", "C"),
    ("F239630FOASS", "3963000000000Y", "EL", "C"),
    ("F142199SIP", "4219900000000Y", "EL", "C"),
    ("F143110VIB", "4311003000000Y", "EL", "C"),
    ("F143110VLB", "4311002000000Y", "EL", "C"),
    ("F133110ODVIB", "3311003000000Y", "EL", "C"),
    ("F143110VFBI", "4311081000000Y", "EL", "C"),
    ("F144111", "4411100000000Y", "EL", "C"),
    ("F142133CM", "4213300000000Y", "EL", "C"),
]


# =====================================================
# File Generation Functions
# =====================================================

def create_walw_formats_parquet():
    """Create WALW formats parquet file from format data"""

    # Combine all format data
    all_formats = WALW_FORMAT_DATA + DAYA_FORMAT_DATA + EL_FORMAT_DATA

    # Convert to DataFrame
    df = pl.DataFrame({
        "SET_ID": [row[0] for row in all_formats],
        "BNMCODE": [row[1] for row in all_formats],
        "FMTNAME": [row[2] for row in all_formats],
        "TYPE": [row[3] for row in all_formats]
    })

    # Write to parquet
    df.write_parquet(WALW_FORMATS_FILE)
    print(f"Created {WALW_FORMATS_FILE} with {len(df)} format mappings")

    return df


def create_dayitem_parquet(walw_formats_df):
    """
    Create DAYITEM parquet file for daily item lookups
    Filters formats where FMTNAME IN ('DAYA','EL') and keeps unique SET_IDs
    This replicates the DAYITEM index creation in the SAS program
    """

    # Filter for DAYA and EL formats
    dayitem_df = walw_formats_df.filter(
        pl.col("FMTNAME").is_in(["DAYA", "EL"])
    ).select("SET_ID").unique().sort("SET_ID")

    # Write to parquet
    dayitem_df.write_parquet(DAYITEM_FILE)
    print(f"Created {DAYITEM_FILE} with {len(dayitem_df)} unique daily item SET_IDs")

    return dayitem_df


def generate_format_lookup_dict(df: pl.DataFrame) -> Dict[str, str]:
    """
    Generate a Python dictionary for fast lookups
    Maps SET_ID to BNMCODE for the BNMCODE format
    """

    bnmcode_df = df.filter(pl.col("FMTNAME") == "BNMCODE")
    lookup = dict(zip(bnmcode_df["SET_ID"], bnmcode_df["BNMCODE"]))

    return lookup


# =====================================================
# Main Processing
# =====================================================

def main():
    """Main function to generate format files"""

    print("=" * 70)
    print("WALWPBBF - Format Definition File Generation")
    print("=" * 70)

    # Step 1: Create WALW formats parquet file
    print("\nStep 1: Creating WALW formats parquet file...")
    walw_formats_df = create_walw_formats_parquet()

    # Step 2: Create DAYITEM parquet file
    print("\nStep 2: Creating DAYITEM parquet file...")
    dayitem_df = create_dayitem_parquet(walw_formats_df)

    # Step 3: Generate lookup dictionary and save summary statistics
    print("\nStep 3: Generating format statistics...")
    format_summary = walw_formats_df.group_by("FMTNAME").agg(
        pl.col("SET_ID").count().alias("COUNT"),
        pl.col("SET_ID").n_unique().alias("UNIQUE_COUNT")
    ).sort("FMTNAME")

    print("\nFormat Summary:")
    print(format_summary)

    # Step 4: Sample output for verification
    print("\nSample BNMCODE formats (first 10):")
    bnmcode_sample = walw_formats_df.filter(
        pl.col("FMTNAME") == "BNMCODE"
    ).head(10)
    print(bnmcode_sample)

    print("\n" + "=" * 70)
    print("Format files successfully created!")
    print(f"  - WALW Formats: {WALW_FORMATS_FILE}")
    print(f"  - DAYITEM Index: {DAYITEM_FILE}")
    print("=" * 70)


if __name__ == "__main__":
    main()
