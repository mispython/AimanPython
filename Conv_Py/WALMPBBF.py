#!/usr/bin/env python3
"""
Program: WALMPBBF
Creates BNMCODE format lookup table for Walker items
"""

import polars as pl
from pathlib import Path

# Setup paths
# INPUT_DIR = Path("input")
# OUTPUT_DIR = Path("output")

BASE_DIR = Path(__file__).resolve().parent

INPUT_DIR = BASE_DIR / "data"
OUTPUT_DIR = BASE_DIR / "output"

# Create directories if they don't exist
INPUT_DIR.mkdir(exist_ok=True)
OUTPUT_DIR.mkdir(exist_ok=True)

# Define output file path
OUTPUT_FILE = OUTPUT_DIR / "WALM.parquet"

# WALM format data from CARDS section
walm_data = [
    {"START": "R235220DSTB", "LABEL": "3522000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235320DSIUB", "LABEL": "3532000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235330DSGDS", "LABEL": "3533000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235340DSICN", "LABEL": "3534000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235349IAB", "LABEL": "3534900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235420DSUCB", "LABEL": "3542000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235430DSCN", "LABEL": "3543000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235500CAGA", "LABEL": "3550000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235599DS", "LABEL": "3559900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R235599DSOTR", "LABEL": "3559900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236013QSMP", "LABEL": "3601300000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236049BA", "LABEL": "3604900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236070ISPTF", "LABEL": "3607000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236210MGS", "LABEL": "3621000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236220ISTB", "LABEL": "3622000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236250BNM", "LABEL": "3625000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236320ISIUB", "LABEL": "3632000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236330ISGDS", "LABEL": "3633000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236340ISICN", "LABEL": "3634000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236349IAB", "LABEL": "3634900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236420ISUCB", "LABEL": "3642000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236430ISCN", "LABEL": "3643000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236500CAGA", "LABEL": "3650000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236599IS", "LABEL": "3659900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236599ISOTR", "LABEL": "3659900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R236600FXSEC", "LABEL": "3660000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239121QUO", "LABEL": "3912100000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239122UNQUO", "LABEL": "3912200000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239132UNASS", "LABEL": "3913200000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239140INVFD", "LABEL": "3914000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239151LAND", "LABEL": "3915100000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239152TRANS", "LABEL": "3915200000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239153OEFUR", "LABEL": "3915300000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239154COMP", "LABEL": "3915400000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239159OFA", "LABEL": "3915900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239160FPROP", "LABEL": "3916000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239210INTR", "LABEL": "3921000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239220CHQP", "LABEL": "3922000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239230IBR", "LABEL": "3923000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239299OA", "LABEL": "3929900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239360IFP", "LABEL": "3936000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239399ASSET", "LABEL": "3939900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239620FOSUB", "LABEL": "3962000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R239630FOASS", "LABEL": "3963000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "F241109PRR", "LABEL": "4110900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241101OSC", "LABEL": "4110100000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241701IWF", "LABEL": "4170100000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241102SP", "LABEL": "4110200000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241103SRF", "LABEL": "4110300000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241104GRF", "LABEL": "4110400000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241105RPAL", "LABEL": "4110500000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241705IRPAL", "LABEL": "4170500000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241107CUPL", "LABEL": "4110700000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241108PYPL", "LABEL": "4110800000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R241707ICUPL", "LABEL": "4170700000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "F247120", "LABEL": "4712000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R242399IODEP", "LABEL": "4239900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R242320ISA", "LABEL": "4232000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R242330IGIDA", "LABEL": "4233000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249110INTP", "LABEL": "4911000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249120BP", "LABEL": "4912000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249240DT", "LABEL": "4924000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249250DP", "LABEL": "4925000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249299OL", "LABEL": "4929900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249320IBP", "LABEL": "4932000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249130AP", "LABEL": "4913000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249330IAP", "LABEL": "4933000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249150SPBDD", "LABEL": "4915000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249350ISPBD", "LABEL": "4935000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249160GPBDD", "LABEL": "4916000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249360IGPBD", "LABEL": "4936000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249170IIS", "LABEL": "4917000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249180PDVS", "LABEL": "4918000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249380IPDVS", "LABEL": "4938000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249190PDVDS", "LABEL": "4919000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249390IPDDS", "LABEL": "4939000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249220DFA", "LABEL": "4922000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249230PTAX", "LABEL": "4923000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R249399LIAB", "LABEL": "4939900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R254120HLCR", "LABEL": "5412000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R259910OBC", "LABEL": "5991000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R259920BA", "LABEL": "5992000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "R259999MISC", "LABEL": "5999900000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "F249400", "LABEL": "4940050000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
    {"START": "F132620FXCA", "LABEL": "3262000000000Y", "FMTNAME": "BNMCODE", "TYPE": "C"},
]

# Create Polars DataFrame
df = pl.DataFrame(walm_data)

# Write to parquet
df.write_parquet(OUTPUT_FILE)

print(f"Successfully created {OUTPUT_FILE}")
print(f"Total records: {len(df)}")
print(f"Format name: BNMCODE")
print(f"Format type: Character (C)")
