OPTIONS YEARCUTOFF=1950 NOCENTER NODATE;
*;
DATA REPTDTE1;
  SET LOAN1.REPTDATE;
  MMD=MONTH(REPTDATE);
    IF MMD IN (01,02,03) THEN QTR='Q1';  ELSE
    IF MMD IN (04,05,06) THEN QTR='Q2';  ELSE
    IF MMD IN (07,08,09) THEN QTR='Q3';  ELSE
    IF MMD IN (10,11,12) THEN QTR='Q4';
  CALL SYMPUT('YYD',PUT(REPTDATE,YEAR2.));
  CALL SYMPUT('QTR',PUT(QTR,$2.));
  CALL SYMPUT('RDATE',PUT(REPTDATE,DDMMYY8.));
  CALL SYMPUT('XDATE',PUT(REPTDATE,Z5.));
RUN;
*;
DATA REPTDTE2;
  SET LOAN2.REPTDATE;
  CALL SYMPUT('YDATE',PUT(REPTDATE,Z5.));
RUN;
*;
DATA RMCA;
   DROP NBALAN;
   SET  TRBL.RMCA&QTR&YYD;
   IF   CUSTCODE IN (63,68);
   IF   ("&YDATE"< TRDATE<="&XDATE");
   IF   LEDGBAL < 0.01;
   NBALAN=LEDGBAL*-1;
   APPRLIMT=ROUND(APPRLIMT,.01);
   OVERDRWN=ROUND(NBALAN-APPRLIMT,.01);
   IF   OVERDRWN > 0.00;
*;
PROC SORT; BY BRANCH ACCTNO TRDATE;
*;
PROC REPORT DATA=RMCA NOWD HEADSKIP HEADLINE NOCENTER;
COLUMN BRANCH NAME ACCTNO CUSTCODE PRODUCT TRXDATE LEDGBAL APPRLIMT
       OVERDRWN;
DEFINE BRANCH    /  DISPLAY 'BRH'          FORMAT=3.;
DEFINE NAME      /  DISPLAY 'NAME'         FORMAT=$15.;
DEFINE ACCTNO    /  DISPLAY 'ACCOUNT NO'   FORMAT=10.;
DEFINE CUSTCODE  /  DISPLAY 'CUST/CODE'    FORMAT=4.;
DEFINE PRODUCT   /  DISPLAY 'TYP'          FORMAT=3.;
DEFINE TRXDATE   /  DISPLAY 'TRX/DATE'     FORMAT=$8.;
DEFINE LEDGBAL   /  DISPLAY 'OD BALANCE'   FORMAT=12.2;
DEFINE APPRLIMT  /  DISPLAY 'APPRLIMT'     FORMAT=12.2;
DEFINE OVERDRWN  /  DISPLAY 'OVERDRWN'     FORMAT=12.2;
TITLE1 'PUBLIC BANK BERHAD: ';
TITLE2 'OVERDRAWN CURRENT ACCOUNTS (NRCC) AS AT ' &RDATE;
*;
