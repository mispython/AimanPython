//EIAWOF09 JOB MISEIS,EIFAWN01,CLASS=A,MSGCLASS=X,NOTIFY=&SYSUID
//*
//EIAWOF09 EXEC SAS609
//NPL      DD DSN=SAP.PBB.NPL.HP.SASDATA.WOFF,DISP=OLD
//NPLA     DD DSN=SAP.PBB.NPL.HP.SASDATA,DISP=SHR
//SYSIN    DD *
*--------------------------------------------------------------------*
*  COPY AND RENAME ALL RELATED FIELDS FROM EXISTING NPL              *
*  IE. IIS, SAQ & SP2 FOR HARDCODING OF WRITTEN ACCTS                *
*  RUN ONLY ON WRITE OFF ACCOUNTS                                    *
*--------------------------------------------------------------------*;
OPTION NOCENTER;

DATA REPTDATE(KEEP=REPTDATE);
  SET NPLA.REPTDATE;
  CALL SYMPUT('RDATE',REPTDATE);
RUN;

PROC SORT DATA=NPLA.IIS OUT=IIS;BY ACCTNO;
PROC SORT DATA=NPLA.AQ  OUT=AQ; BY ACCTNO;
PROC SORT DATA=NPLA.SP2 OUT=SP2;BY ACCTNO;
PROC SORT DATA=NPL.WOFFHP OUT=WFHP;BY ACCTNO;
DATA NPL.TIIS;
   KEEP ACCTNO NOTENO WSUSPEND WRECOVER WRECC WOISUSP WOIRECV WOIRECC
        WDATE;
   MERGE IIS(IN=B) WFHP(IN=A);BY ACCTNO;
   IF A AND B;
   WSUSPEND = SUSPEND;
   WRECOVER = ROUND(RECOVER,.01);
   WRECC    = RECC;
   WOISUSP  = OISUSP;
   WOIRECV  = OIRECV;
   WOIRECC  = OIRECC;
   WDATE    = &RDATE;
RUN;
PROC PRINT DATA=NPL.TIIS;

DATA NPL.TAQ;
   KEEP ACCTNO NOTENO WNEWNPL WACCRINT WRECOVER
        WDATE;
   MERGE AQ(IN=B) WFHP(IN=A);
   BY ACCTNO;
   IF A AND B;
   WNEWNPL  = NEWNPL;
   WACCRINT = ACCRINT;
   WRECOVER = RECOVER;
   WDATE    = &RDATE;
   * IF WOFFINT NE  . THEN WACCRINT = WOFFINT;
   * IF WOFFREC NE  . THEN WRECOVER = WOFFREC;
RUN;
PROC PRINT;

DATA NPL.TSP2;
   KEEP ACCTNO NOTENO WSPPL WRECOVER WDATE;
   MERGE SP2(IN=B) WFHP(IN=A);BY ACCTNO;
   IF A AND B;
   WSPPL    = SPPL;
   WRECOVER = RECOVER;
   WDATE    = &RDATE;
RUN;
PROC PRINT;
*;
//*
