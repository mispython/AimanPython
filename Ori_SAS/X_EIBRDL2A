/** PROGRAM : PBBRDAL2                       **/
/** DATE    : 22/1/97                        **/
/** REPORT  : RDAL PART II                   **/

DATA OTHER;
  SET BNM.DALM&REPTMON&NOWK
      BNM.FALM&REPTMON&NOWK
      BNM.KALM&REPTMON&NOWK
      BNM.NALM&REPTMON&NOWK
      BNM.LALM&REPTMON&NOWK;
RUN;

PROC SUMMARY DATA=OTHER NWAY;
CLASS BNMCODE AMTIND;
VAR AMOUNT;
OUTPUT OUT=OTHER (DROP=_TYPE_ _FREQ_)
       SUM=AMOUNT;
RUN;
PROC SORT DATA=OTHER OUT=OTHER;
BY BNMCODE AMTIND;
RUN;

DATA BNM.ALMKM&REPTMON (KEEP=ITCODE AMOUNT AMTIND);
  LENGTH BNMCODE $14.;
  SET OTHER (RENAME=(AMOUNT=OTHAMT) IN=B);
  BY BNMCODE AMTIND;
  RENAME BNMCODE=ITCODE;
     AMOUNT=OTHAMT;
     OUTPUT BNM.ALMKM&REPTMON;
RUN;

PROC SORT DATA=BNM.ALWKM&REPTMON&NOWK;
BY ITCODE AMTIND;

DATA BNM.ALMKM&REPTMON;
   MERGE BNM.ALWKM&REPTMON&NOWK (IN=A)
         BNM.ALMKM&REPTMON      (IN=B);
   BY ITCODE AMTIND;
   IF B AND NOT A;
      IF SUBSTR(ITCODE,1,2) ^ IN ('37') THEN OUTPUT;
RUN;

/* MERGE MONTHLY ITEMS INTO WEEKLY (19/11) */
/* AS EL REPORTING REQUIRE MONTHLY ITEMS   */
PROC APPEND DATA=BNM.ALMKM&REPTMON BASE=BNM.ALWKM&REPTMON&NOWK;
RUN;

PROC DATASETS LIB=BNM NOLIST; DELETE ALMKM&REPTMON; RUN;
