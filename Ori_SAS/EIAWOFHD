//EIAWOFHD JOB MISEIS,EIFWOFFA,MSGCLASS=A,MSGLEVEL=(1,1),CLASS=A,       JOB11490
//         NOTIFY=&SYSUID
/*JOBPARM S=S1M2
//* **********************************************
//*   TO HARDCODE SP AND IIS AMOUNT FOR WRITTEN OFF A/C
//*   NOTES: SET THE ALIGHMENT TO LEFT
//*          SET WIDTH TO 15 FOR ALL COLUMN
//*          SAVE IT TO TEXT FILE AND UPLOAD TO HOST
//*   NEW METHOD:
//*   ENHANCE HIRE PURCHASE SAS REPORTS WEF Q3-14
//*   AUTOMATE HARDCODING EX VIA ESMR 2014-956
//* **********************************************
//EIAWOFHD EXEC SAS609
//WOFF     DD DSN=RBP2.B033.LN.WRI2.OFF.MIS,DISP=SHR
//NPL      DD DSN=SAP.PBB.NPL.WOFF,DISP=OLD
//SYSIN    DD *

OPTIONS YEARCUTOFF=1950 NOCENTER;

  *** UPLOAD FROM TEXT FILE PROVIDE BY CCD ***;
DATA HP;
   INFILE WOFF;
   INPUT @142 ACCTNO        10.
         @210 WOFFDTE DDMMYY10.
         @220 CAPBAL        16.2
         @236 COSTCTR        4.
         ;
   WOFFDT = UPCASE(PUT(WOFFDTE,MONNAME3.))||' '||PUT(WOFFDTE,YEAR4.);
   IF COSTCTR NOT IN (3000:3999,4043,4048);
   DROP WOFFDTE COSTCTR;
RUN;
PROC SORT; BY ACCTNO; RUN;
PROC PRINT; SUM CAPBAL; RUN;

DATA NPL.HPWOFF;
   SET HP NPL.HPWOFF;
RUN;
PROC SORT DATA=NPL.HPWOFF NODUPKEYS; BY ACCTNO; RUN;

